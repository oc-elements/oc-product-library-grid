<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-data-table/iron-data-table.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../mercury-paginator/mercury-paginator.html">
<!--<link rel="import" href="../oc-iron-data-table-styles/oc-iron-data-table-styles.html">-->

<!--
`oc-product-library-grid`
A grid to display product library items

@demo demo/index.html
-->

<dom-module id="oc-product-library-grid">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <paper-input label="Filter" always-float-label value="{{filter}}"></paper-input>

    <iron-data-table filter='{{filterObj}}' items="[[data]]">
      <data-table-column name="Name" sort-by="name">
        <template>[[item.name]]</template>
      </data-table-column>
      <data-table-column name="Display Name" sort-by="displayName">
        <template>[[item.displayName]]</template>
      </data-table-column>
      <data-table-column name="Options" sort-by="options">
        <template is="dom-repeat" item="[[item.options]]" as="option">[[option.name]]</template>
      </data-table-column>
      <data-table-column name="Enabled" sort-by="enabled">
        <template>
          <paper-checkbox checked="[[item.enabled]]" on-change="_enabledHandler"></paper-checkbox>
        </template>
      </data-table-column>
      <data-table-column name="Actions">
        <template>

          <div data-option-object$="{{item}}">
            <paper-icon-button id="edit" icon="create" title="Edit Set"  on-tap="_actionHandler"></paper-icon-button>
            <paper-icon-button id="clone" icon="content-copy" title="Clone Set" data-options-id$="{{item.id}}" on-tap="_actionHandler"></paper-icon-button>
            <paper-icon-button id="d" icon="content-copy" title="Clone Set" data-options-id$="{{item.id}}" on-tap="_actionHandler"></paper-icon-button>
          </div>

        </template>
      </data-table-column>
    </iron-data-table>

    <oc-grid-actions >

    </oc-grid-actions>

  </template>

  <script>
    Polymer({

      is: 'oc-product-library-grid',

      properties: {
        data : {
          type: Array
        },
        filter : {
          type: String,
          value : function(){
            return ""
          },
          observer: "_filterHandler"
        },
        filterObj : {
          type: Object,
          value: function(){
            return {}
          }
        }
      },

      _actionHandler : function(e) {
        var optionObj = Polymer.dom(event).localTarget.parentElement.getAttribute('data-option-object'),
                action = e.target.getAttribute('id');

        this.fire('on-'+action, optionObj);
      },

      _enabledHandler: function(e){
        var status = Polymer.dom(e).localTarget.hasAttribute('checked');
        this.fire('on-enabled-toggle', status);
      },

      _filterHandler : function(filterValue){
        this.filterObj = [{"path" : "name"}, {"path" : "displayName"}];

        for(var i=0; i<this.filterObj.length; i++){
          this.filterObj[i].filter = filterValue || "";
        }

        console.log(this.filterObj);

      }



    });
  </script>
</dom-module>
